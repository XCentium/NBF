<div class="ma-settings" ng-controller="NbfCreateAccountController as vm" ng-cloak>
    <p>
        {{vm.settings | json}}
    </p>

    <div class="row">
        <div class="medium-6 large-6 columns ca-form">
            <form id="createAccountForm">
                <div class="required-msg">
                    <span class="redTxt">*</span> [% translate 'Required' %]
                </div>
                <div class="row ca-form-firstName">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_FirstName">[% translate 'First Name' %] <span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="text" id="CreateNewAccountInfo_FirstName" name="CreateNewAccountInfo.FirstName"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'First Name' EscapeSingleQuotes %]') }}"
                               ng-model="vm.userFirstName">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.FirstName" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="row ca-form-lastName">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_LastName">[% translate 'Last Name' %] <span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="text" id="CreateNewAccountInfo_LastName" name="CreateNewAccountInfo.LastName"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Username' EscapeSingleQuotes %]') }}"
                               ng-model="vm.userLastName">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.LastName" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="row ca-form-phone">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_Phone">[% translate 'Phone' %] <span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="text" id="CreateNewAccountInfo_Phone" name="CreateNewAccountInfo.Phone"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Phone' EscapeSingleQuotes %]') }}"
                               data-rule-regex="{{'[% phoneRegex %]'}}"
                               data-msg-regex="{{'[% siteMessage 'AddressInfo_Phone_Validation' EscapeSingleQuotes %]' }}"
                               ng-model="vm.userPhone">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.Phone" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="row ca-form-email">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_EmailAddress">[% translate 'Email Address' %] <span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="text" id="CreateNewAccountInfo_EmailAddress" name="CreateNewAccountInfo.EmailAddress"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Email Address' EscapeSingleQuotes %]') }}"
                               data-rule-email="true"
                               data-msg-email="{{ '[% siteMessage 'Field_Invalid' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Email Address' EscapeSingleQuotes %]') }}"
                               ng-model="vm.email">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.EmailAddress" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="row ca-form-password">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_Password">[% translate 'Password' %] <span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="password" id="CreateNewAccountInfo_Password" name="CreateNewAccountInfo.Password"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Password' EscapeSingleQuotes %]') }}"
                               data-rule-minlength="{{ vm.settings.passwordMinimumLength}}"
                               data-msg-minlength="{{ '[% siteMessage 'ChangePasswordInfo_Password_Too_Short' EscapeSingleQuotes %]'.replace('{0}', vm.settings.passwordMinimumLength) }}"
                               data-rule-pattern="^(?=.*[a-z])(?=.*[A-Z])[a-zA-Z\d]{8,}$"
                               data-msg-pattern="[% siteMessage 'ChangePasswordInfo_Password_Not_Meet_Requirements' EscapeSingleQuotes %]"
                               ng-model="vm.password">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.Password" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="row ca-form-retype">
                    <div class="medium-5 large-5 columns">
                        <label for="CreateNewAccountInfo_ConfirmPassword">[% translate 'Confirm Password' %]<span class="redTxt">*</span></label>
                    </div>
                    <div class="medium-7 large-7 columns">
                        <input type="password" id="CreateNewAccountInfo_ConfirmPassword" name="CreateNewAccountInfo.ConfirmPassword"
                               data-rule-required="true"
                               data-msg-required="{{ '[% siteMessage 'Field_Required' EscapeSingleQuotes %]'.replace('{0}', '[% translate 'Confirm Password' EscapeSingleQuotes %]') }}"
                               data-rule-equalto="#CreateNewAccountInfo_Password"
                               data-msg-equalto="[% siteMessage 'CreateNewAccountInfo_PasswordCombination_DoesNotMatch' %]"
                               ng-model="vm.confirmPassword">
                        <span class="field-validation-valid" data-valmsg-for="CreateNewAccountInfo.ConfirmPassword" data-valmsg-replace="true"></span>
                    </div>
                </div>
                <div class="bill-to">
                    <h3>[% translate 'Billing Information' %]</h3>
                    <div class="bill-to-form">
                        <div class="billing-info">
                            <div class="required-msg" style="height: 53px; margin: 0"><span class="redTxt">*</span>[% translate 'Required' %]</div>
                            <isc-address-edit prefix="bt" address="vm.billTo" countries="vm.countries" address-fields="vm.addressFields.billToAddressFields"
                                              set-state-required-rule="vm.setStateRequiredRule('bt', vm.billTo)"></isc-address-edit>
                        </div>
                    </div>
                </div>
                <div class="ship-to">
                    <h3>[% translate 'Shipping Information' %]</h3>
                    <div>
                        <label for="sameAsShipping">[% translate 'Same as billing' %]</label>
                        <input name="sameAsShipping" type="checkbox" ng-model="vm.shipToSameAsBillTo" ng-change="vm.checkSelectedShipTo()" />
                    </div>
                    <div class="ship-to-form" ng-hide="vm.isReadOnly">
                        <div class="shipping-info">
                            <isc-address-edit prefix="st" address="vm.shipTo" countries="vm.countries" address-fields="vm.addressFields.shipToAddressFields"
                                              is-read-only="vm.isReadOnly" set-state-required-rule="vm.setStateRequiredRule('st', vm.shipTo)"></isc-address-edit>
                        </div>
                    </div>
                </div>
                <div>
                    [% zone 'TermsAndConditions' %]
                </div>
                
                <div class="error">
                    <span class="field-validation-error" ng-if="vm.createError" ng-bind="vm.createError"></span>
                </div>
                <div class="btns">
                    <button type="submit" class="btn primary btn-long" ng-click="vm.createAccount()">[% translate 'Create Account' %]</button>
                </div>
            </form>
        </div>
        <div class="medium-6 large-6 columns manage-subs password-requirements">
            <h4>[% translate 'Password requirements' %]:</h4>
            <div>
                <div class="pw-note">{{'[% translate 'Password must be at least {0} characters long' %]'.replace('{0}', vm.settings.passwordMinimumLength)}}</div>
                <div class="pw-note" ng-if="vm.settings.minRequiredDigits">[% translate 'Password must include at least one number' %]</div>
                <div class="pw-note" ng-if="vm.settings.minRequiredNonAlphanumericCharacters">[% translate 'Password must include at least one non alphanumeric character' %]</div>
                <div class="pw-note" ng-if="vm.settings.minRequiredUppercase">[% translate 'Password must include at least one uppercase character' %]</div>
                <div class="pw-note" ng-if="vm.settings.minRequiredLowercase">[% translate 'Password must include at least one lowercase character' %]</div>
            </div>
        </div>
    </div>

    <script type="text/ng-template" id="/PartialViews/Account-AddressEdit">
            [% partialView 'Account-AddressEdit' %]
        </script>
    <script type="text/ng-template" id="/PartialViews/Account-AddressField">
            [% partialView 'Account-AddressField' %]
    </script>
</div>
